# ═══════════════════════════════════════════════════
# Scalara — Docker Compose (Self-Hosted Webmail)
# ═══════════════════════════════════════════════════
#
# Use this ONLY if you want to self-host the webmail
# on a SEPARATE server (not on the VPS running the engine).
#
# For Vercel deployment (recommended), you don't need this file.
# Just push webmail/ to GitHub and deploy on vercel.com.
#
# The VPS email engine (Postfix/Dovecot/PostgreSQL) is
# installed natively via: sudo bash installer/install.sh
#
# Usage:
#   1. Copy .env.example to .env and fill in values
#   2. docker compose up -d
# ═══════════════════════════════════════════════════

version: "3.9"

services:
  webmail:
    build:
      context: ./webmail
      dockerfile: Dockerfile
    container_name: scalara-webmail
    restart: unless-stopped
    env_file:
      - ./webmail/.env
    ports:
      - "3000:3000"
    healthcheck:
      test: ["CMD", "wget", "-qO-", "http://localhost:3000/api/auth/session"]
      interval: 30s
      timeout: 10s
      retries: 3
